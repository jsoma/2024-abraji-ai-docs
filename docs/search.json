[
  {
    "objectID": "using-pdfs.html",
    "href": "using-pdfs.html",
    "title": "Preparing PDFs for AI analysis",
    "section": "",
    "text": "If you have a PDF with selectable text, it’s simple to extract the text using pdfminer.six, a Python tool. And if you’re not using Python, just could just cut and paste!\nWe’ll start by installing pdfminer.six.\n%pip install --quiet --upgrade pdfminer.six\n\n\n[notice] A new release of pip is available: 23.0.1 -&gt; 24.1.2\n[notice] To update, run: pip install --upgrade pip\nNote: you may need to restart the kernel to use updated packages.\nOnce it’s installed, pdfminer.six is remarkably easy to use!\nfrom pdfminer.high_level import extract_text\n\ntext = extract_text(\"pdf-documents/presentation.pdf\")\nprint(text)\n\npowerpoint\n\nTuesday, December 08, 2015\n\n9:33 AM\n\nSubject\n\npowerpoint\n\nFrom\n\nTo\n\nSent\n\nAttachments\n\nGreen, Cary -FS\n\nJackson, William F -FS\n\nFriday, May 01, 2015 10:58 AM\n\nSumCo\nForest He...\n\nBill – here is a powerpoint presentation from last fall that I presented to Summit County citizens. Has \nsome of the data you were asking for earlier.\n\nCary\n\nCary Green, Forester \nEast Zone TMA\n\nForest Service \nWhite River National Forest, Eagle/Holy Cross Ranger District\n\np: 970-827-5160 \nc: 970-390-3234 \nf: 970-827-9343 \ncgreen@fs.fed.us\n\n24747 US Highway 24, PO Box 190 \nMinturn, CO 81645\nwww.fs.fed.us\n\nCaring for the land and serving people\n\nGeneral Page 1\nBut you usually don’t just have one PDF, usually you have a lot of them!",
    "crumbs": [
      "Preparing PDFs"
    ]
  },
  {
    "objectID": "using-pdfs.html#opening-many-pdf-files-and-saving-to-csv",
    "href": "using-pdfs.html#opening-many-pdf-files-and-saving-to-csv",
    "title": "Preparing PDFs for AI analysis",
    "section": "Opening many PDF files and saving to CSV",
    "text": "Opening many PDF files and saving to CSV\nIn the most common use case, you have a folder full of PDFs and you need to convert them into a CSV file, where every row has the PDF content. Then you can use the tools we talked about to analyze them with Google Sheets or Python.\n\n%pip install --upgrade --quiet pandas\n\n\n[notice] A new release of pip is available: 23.0.1 -&gt; 24.1.2\n[notice] To update, run: pip install --upgrade pip\nNote: you may need to restart the kernel to use updated packages.\n\n\n\nimport glob\nimport pandas as pd\nfrom pdfminer.high_level import extract_text\n\npd.options.display.max_colwidth = 200\n\n# Find all of the pdfs from inside of the \"pdf-documents\" folder\nfilenames = glob.glob(\"pdf-documents/*.pdf\")\n\n# Get the text for each of them\ncontents = [extract_text(filename) for filename in filenames]\n\n# Turn it into a spreadsheet\ndf = pd.DataFrame({\n    'filename': filenames,\n    'content': contents\n})\n\n# Save the file as saved.csv\ndf.to_csv(\"saved.csv\", index=False)\n\ndf\n\n\n\n\n\n\n\n\n\nfilename\ncontent\n\n\n\n\n0\npdf-documents/Forest Service burn piles.pdf\nForest Service burn piles\\n\\nTuesday, December 08, 2015\\n\\n9:54 AM\\n\\nSubject\\n\\nForest Service burn piles\\n\\nFrom\\n\\nJackson, William F -FS\\n\\nTo\\n\\nCc\\n\\nbrownellbailey@gmail.com\\n\\nWilmore, Ros...\n\n\n1\npdf-documents/April 3 - Dillon Veg project activity meeting.pdf\nApril 3 - Dillon Veg project activity meeting\\n\\nTuesday, December 08, 2015\\n\\n8:44 AM\\n\\nSubject\\n\\nApril 3 - Dillon Veg project activity meeting\\n\\nFrom\\n\\nGreen, Cary -FS\\n\\nTo\\n\\nCc\\n\\nWilmore...\n\n\n2\npdf-documents/7 Day Staffing.pdf\n7 Day Staffing\\n\\nTuesday, December 08, 2015\\n\\n9:57 AM\\n\\nSubject\\n\\n7 Day Staffing\\n\\nFrom\\n\\nConrad, Justin D -FS\\n\\nTo\\n\\nCc\\n\\nWilmore, Ross D -FS; Neely, David -FS; Mayville, Aaron W -FS; Ke...\n\n\n3\npdf-documents/EZ Pile campaign update PP3.pdf\nEZ Pile campaign update PP3\\n\\nTuesday, December 08, 2015\\n\\n9:48 AM\\n\\nSubject\\n\\nEZ Pile campaign update PP3\\n\\nFrom\\n\\nTo\\n\\nWilmore, Ross D -FS\\n\\nMayville, Aaron W -FS; Keller, Cynthia P -FS;...\n\n\n4\npdf-documents/BOCC to Howard Brown May 2015 from Karn.pdf\nBOCC to Howard Brown May 2015.docx\\n\\nTuesday, December 08, 2015\\n\\n8:22 AM\\n\\nSubject\\n\\nBOCC to Howard Brown May 2015.docx\\n\\nFrom\\n\\nTo\\n\\nSent\\n\\nAttachments\\n\\nKarnS\\n\\nJackson, William F -FS...\n\n\n5\npdf-documents/presentation.pdf\npowerpoint\\n\\nTuesday, December 08, 2015\\n\\n9:33 AM\\n\\nSubject\\n\\npowerpoint\\n\\nFrom\\n\\nTo\\n\\nSent\\n\\nAttachments\\n\\nGreen, Cary -FS\\n\\nJackson, William F -FS\\n\\nFriday, May 01, 2015 10:58 AM\\n\\nS...\n\n\n6\npdf-documents/BOCC to Howard Brown May 2015.pdf\nBoard of County Commissioners \\n\\n970-453-2561 \\nPost Office Box 68 \\n208 East Lincoln Avenue \\nBreckenridge, Colorado 80424 \\n\\nMay 7, 2015 \\n\\nMr. Howard Brown \\n376 Spring Beauty Dr. \\nP.O. Box...\n\n\n7\npdf-documents/2016-2020 Denver Water 5 year plan proposals - reply due May 28th.pdf\n2016-2020 Denver Water 5 year plan proposals - reply \\ndue May 28th\\n\\nTuesday, December 08, 2015\\n\\n8:18 AM\\n\\nSubject\\n\\n2016-2020 Denver Water 5 year plan proposals - reply due May 28th\\n\\nFrom...\n\n\n8\npdf-documents/DWB_ProjectProposals_Recreation_5_29_15.pdf\nForest Service Road Decommissioning \\n\\nProject Description \\nSix miles of existing roads would be decommissioned over three years. Road decommissioning \\nis defined as: \"Activities that result i...\n\n\n9\npdf-documents/EZ Pile burning update PP2.pdf\nEZ Pile burning update PP2\\n\\nTuesday, December 08, 2015\\n\\n9:47 AM\\n\\nSubject\\n\\nEZ Pile burning update PP2\\n\\nFrom\\n\\nWilmore, Ross D -FS\\n\\nTo\\n\\nMayville, Aaron W -FS; Keller, Cynthia P -FS; G...\n\n\n10\npdf-documents/Copy of KeystoneStewardship.pdf\nKeystone Stewardship Unit \\n\\nplot\\n\\nconstant\\n\\n1\\n\\n2\\n\\n3\\n\\n4\\n\\n5\\n\\n6\\n\\n7\\n\\n8\\n\\n9\\n\\n10\\n\\n11\\n\\n12\\n\\ntotal\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11.64\\n\\n11...\n\n\n11\npdf-documents/Breckenridge Prescribed Burn Operations.pdf\nBreckenridge Prescribed Burn Operations\\n\\nTuesday, December 08, 2015\\n\\n9:45 AM\\n\\nSubject\\n\\nBreckenridge Prescribed Burn Operations\\n\\nFrom\\n\\nAyres, Todd -FS\\n\\nTo\\n\\nCc\\n\\nSent\\n\\nalangley (a...\n\n\n12\npdf-documents/2015 Summit County AOP Final Version 150330.pdf\n2015 SUMMIT COUNTY WILDFIRE \\nANNUAL OPERATING PLAN \\n\\nPage 1 of 48 \\n\\n \\n \\n \\n \\n \\n\fContents \\nPREAMBLE ..........................................................................................\n\n\n13\npdf-documents/FW News Item -- Citizens Plead for Stop to Ophir Mountain Clear-Cutting.pdf\nFW: News Item -- Citizens Plead for Stop to Ophir \\nMountain Clear-Cutting\\n\\nTuesday, December 08, 2015\\n\\n8:51 AM\\n\\nSubject\\n\\nFW: News Item -- Citizens Plead for Stop to Ophir Mountain Clear-C...\n\n\n14\npdf-documents/Dillon_CCI Needs Summer 2015.pdf\nWRNF Request for CCI Assistance \\n\\n2015 \\n\\nDillon RD CCI Needs Summer 2015 \\n\\n1) Burn pile rehab (Keystone, Swan, Barton, Peak 7 South) scatter or pile burned debris depending on \\namount, scar...\n\n\n15\npdf-documents/EZ Pile Burning Update PP 1.pdf\nEZ Pile Burning Update PP 1\\n\\nTuesday, December 08, 2015\\n\\n9:44 AM\\n\\nSubject\\n\\nEZ Pile Burning Update PP 1\\n\\nFrom\\n\\nWilmore, Ross D -FS\\n\\nTo\\n\\nMayville, Aaron W -FS; Keller, Cynthia P -FS;...\n\n\n16\npdf-documents/Mount Powell Salvage Timber Sale.pdf\nMount Powell Salvage Timber Sale\\n\\nTuesday, December 08, 2015\\n\\n8:26 AM\\n\\nSubject Mount Powell Salvage Timber Sale\\n\\nFrom\\n\\nCunning, Ken -FS\\n\\nTo\\n\\nCc\\n\\nJackson, William F -FS\\n\\nBraudis, ...\n\n\n17\npdf-documents/BOCC Response Letter to Howard Brown Petition.pdf\nBOCC Response Letter to Howard Brown Petition\\n\\nTuesday, December 08, 2015\\n\\n8:21 AM\\n\\nSubject\\n\\nBOCC Response Letter to Howard Brown Petition\\n\\nFrom\\n\\nTo\\n\\nSent\\n\\nAttachments\\n\\nEvaH\\n\\nJ...\n\n\n18\npdf-documents/Jackson_email-02.pdf\nKight, Bill -FS\\n\\nFrom:\\nSent:\\nTo:\\nSubject:\\nSigned By:\\n\\nJackson, William F -FS\\nSaturday, February 07, 2015 6:29 AM\\nFS-pdl r2 wr dillon rd\\nFW: EZ Pile burning update PP2\\nwfjackson@fs.fed....\n\n\n19\npdf-documents/Jackson_email-01.pdf\nKight, Bill -FS\\n\\nFrom:\\nSent:\\nTo:\\nCc:\\nSubject:\\n\\nKight, Bill -FS\\nFriday, November 14, 2014 1:11 PM\\nKight, Bill -FS\\nFS-r2_whiteriver\\nCrews to begin burning slash piles in Summit County Mo...\n\n\n\n\n\n\n\n\nEven though we can only see a little bit of the content, I promise it’s all there! Excel will have trouble opening the file (it doesn’t like that the PDF content takes up multiple lines), but if you add it to Google Sheets it’ll look great.\n\n\n\nin sheets\n\n\nIf you need to use OCR to turn images into text, I recommend taking a look at the links on the front page.",
    "crumbs": [
      "Preparing PDFs"
    ]
  },
  {
    "objectID": "slides.html",
    "href": "slides.html",
    "title": "Presentation Slides",
    "section": "",
    "text": "Presentation Slides\nDownload PDF file.",
    "crumbs": [
      "Slides"
    ]
  },
  {
    "objectID": "instructor.html",
    "href": "instructor.html",
    "title": "Extracting structured data with Instructor",
    "section": "",
    "text": "If you have a bunch of data in a messy format (user-input text, usually), an LLM is a great way to pull out the useful parts. Instructor can help you take that content and turn it into structured data!\nLet’s start by installing Instructor. We’ll also install tqdm, which allows for some nice progress bars.\n%pip install --quiet --upgrade instructor tqdm\n\n\n[notice] A new release of pip is available: 23.0.1 -&gt; 24.1.2\n[notice] To update, run: pip install --upgrade pip\nNote: you may need to restart the kernel to use updated packages.",
    "crumbs": [
      "Instructor (Python)"
    ]
  },
  {
    "objectID": "instructor.html#instructor-in-a-single-use",
    "href": "instructor.html#instructor-in-a-single-use",
    "title": "Extracting structured data with Instructor",
    "section": "Instructor in a single use",
    "text": "Instructor in a single use\nFirst we’ll use Instructor on a single line of code. In this case, extracting structured data from an article.\nEach article has a summary, a list of sources, a language and and a category. Each “source” has both a name and an optional title.\nYou’ll need your own OpenAI API key to serve as your username and password when connecting Instructor to GPT. You can get yours here. Feel free to email me to borrow one of my API keys, you can find me at js4571@columbia.edu\n\nimport instructor\nfrom pydantic import BaseModel, Field\nfrom openai import OpenAI\nfrom typing import Optional, List\nfrom typing_extensions import Literal\n\nclass Person(BaseModel):\n    name: str = Field(description=\"Person's name\")\n    title: Optional[str] = Field(description=\"Person's title, if available\")\n\nclass Article(BaseModel):\n    summary: str = Field(description=\"Brief, one-sentence summary (in English)\")\n    sources: List[Person] = Field(description=\"People mentioned in the article\")\n    language_code: str = Field(description=\"Two-letter language code of original text\")\n    category: Literal[\"politics\", \"sports\", \"international\", \"other\"]\n\n# Add your own API key\nclient = instructor.from_openai(OpenAI(api_key='sk-proj-XXXXXXXXXXXXXXXXXXXX'))\n\nThe article we’ll be analyzing is below.\n\narticle = \"\"\"\n\"Elections européennes : Emmanuel Macron dénonce « l'hypocrisie » du RN\n\nLe chef de l'Etat a déploré mercredi depuis Bruxelles que les « peurs profitent aux réponses les plus simplistes » dans la campagne pour le scrutin du 9 juin, fustigeant ceux qui dénoncent l'Union européenne tout en engrangeant les « dividendes silencieux ».\n\nVous pouvez partager un article en cliquant sur les icônes de partage en haut à droite de celui-ci. \nLa reproduction totale ou partielle d'un article, sans l'autorisation écrite et préalable du Monde, est strictement interdite. \nPour plus d'informations, consultez nos conditions générales de vente. \nPour toute demande d'autorisation, contactez syndication@lemonde.fr. \nEn tant qu'abonné, vous pouvez offrir jusqu'à cinq articles par mois à l'un de vos proches grâce à la fonctionnalité « Offrir un article ». \n\nhttps://www.lemonde.fr/elections-europeennes/article/2024/04/17/elections-europeennes-emmanuel-macron-denonce-l-hypocrisie-du-rn_6228404_1168667.html\n\nInterrogé en marge de son déplacement à Bruxelles sur la campagne des élections européennes, Emmanuel Macron a déploré que les « peurs profitent aux réponses les plus simplistes », mercredi 17 avril. Il a également fustigé « l'hypocrisie » de ceux qui dénoncent l'Union européenne mais en engrangent les « dividendes silencieux ».\n\n« Je pense qu'il y a beaucoup de peurs, d'inquiétudes dans le moment que nous vivons et que ces colères profitent toujours aux réponses les plus simplistes », a déclaré le chef de l'Etat français lors de son arrivée dans la capitale belge avant la tenue d'un sommet européen, au cours d'un bref échange avec la presse aux côtés de la tête de liste de son camp aux européennes, Valérie Heyer. « Il y a aujourd'hui une espèce d'hypocrisie du débat et j'espère qu'en rentrant dans les prochaines semaines dans celui-ci, cette hypocrisie sera levée », a ajouté M. Macron, visant en creux le Rassemblement national (RN), dont la liste est conduite par Jordan Bardella.\n\nIl s'agissait de la première apparition publique du chef de l'Etat et de Mme Hayer depuis le début de la campagne, avant qu'ils n'assistent ensemble à une réunion du groupe Renew Europe.\n\nVous pouvez partager un article en cliquant sur les icônes de partage en haut à droite de celui-ci. \nLa reproduction totale ou partielle d'un article, sans l'autorisation écrite et préalable du Monde, est strictement interdite. \nPour plus d'informations, consultez nos conditions générales de vente. \nPour toute demande d'autorisation, contactez syndication@lemonde.fr. \nEn tant qu'abonné, vous pouvez offrir jusqu'à cinq articles par mois à l'un de vos proches grâce à la fonctionnalité « Offrir un article ». \n\nhttps://www.lemonde.fr/elections-europeennes/article/2024/04/17/elections-europeennes-emmanuel-macron-denonce-l-hypocrisie-du-rn_6228404_1168667.html\n\nL'extrême droite ciblée par le camp présidentiel\nLa candidate du camp présidentiel peine pour l'instant à imprimer sa marque dans la campagne. La liste Renaissance reste largement distancée dans les sondages par celle du Rassemblement national (RN), qui ne cesse de creuser l'écart et caracole à plus de 30 % d'intentions de vote. Donnée autour de 16 % d'intentions, elle est également talonnée par celle du PS-Place publique, menée par Raphaël Glucksmann.\n\nLe camp présidentiel est en outre suspendu à une entrée en campagne du chef de l'Etat, dont les contours n'ont pour l'heure pas été précisés, alors que le premier ministre, Gabriel Attal, reste pour l'heure discret en la matière. Ce dernier fait le pari que la campagne ne démarrera réellement que dans la dernière ligne droite, un mois avant le scrutin du 9 juin, mais l'exécutif cible ces dernières semaines l'extrême droite, qu'il considère comme son principal adversaire dans le scrutin.\n\nVous pouvez partager un article en cliquant sur les icônes de partage en haut à droite de celui-ci. \nLa reproduction totale ou partielle d'un article, sans l'autorisation écrite et préalable du Monde, est strictement interdite. \nPour plus d'informations, consultez nos conditions générales de vente. \nPour toute demande d'autorisation, contactez syndication@lemonde.fr. \nEn tant qu'abonné, vous pouvez offrir jusqu'à cinq articles par mois à l'un de vos proches grâce à la fonctionnalité « Offrir un article ». \n\nhttps://www.lemonde.fr/elections-europeennes/article/2024/04/17/elections-europeennes-emmanuel-macron-denonce-l-hypocrisie-du-rn_6228404_1168667.html\n\nDepuis Bruxelles, Emmanuel Macron a fait un premier pas dans l'offensive en vue du scrutin du 9 juin, ciblant ainsi sans le nommer le RN, et ses contradictions sur la question européenne, l'économie ou encore la diplomatie. « Ceux qui parfois il y a cinq ans disaient “la solution c'est sortir de l'euro”, ceux qui ne votent même pas la politique agricole commune mais ensuite disent à la maison aux agriculteurs “je vous défends”, ceux qui systématiquement ont essayé d'affaiblir l'Europe en quelque sorte ont les dividendes silencieux de notre propre politique proeuropéenne », a asséné Emmanuel Macron.\n\n« Ils expliquent, “nous, on va rendre notre pays plus fort”. Si leur politique avait été suivie depuis cinq ans, on ne serait pas là pour parler de la même façon de notre Europe ! », a-t-il poursuivi, avant d'ajouter : « Ils auraient soigné [le Covid-19] à l'hydroxychloroquine, pris le vaccin russe, divisé l'Europe suite à l'agression russe. Ils n'auraient pris aucune sanction [contre la Russie], l'Ukraine aurait déjà été abandonnée. Et ils auraient abandonné aussi l'ambition européenne en matière de recherche et de technologie. »\n\"\"\"\n\nNow we will send the article to GPT, along with the Article formatter. that describes what we want back.\n\nresult = client.chat.completions.create(\n    model=\"gpt-4o\",\n    response_model=Article,\n    messages=[{\"role\": \"user\", \"content\": article}],\n)\n\nThe result was saved as result, which we can look at nicely by printing out result.model_dump(). It’s kind of complicated – there are a lot of sources! – which is why we’re using pretty printing.\n\nfrom pprint import pprint\n\npprint(result.model_dump())\n\n{'category': 'politics',\n 'language_code': 'fr',\n 'sources': [{'name': 'Emmanuel Macron', 'title': 'President of France'},\n             {'name': 'Jordan Bardella',\n              'title': 'Head of the RN list for the European elections'},\n             {'name': 'Valérie Heyer',\n              'title': \"Head of Macron's camp list for the European elections\"},\n             {'name': 'Gabriel Attal', 'title': 'Prime Minister of France'},\n             {'name': 'Raphaël Glucksmann',\n              'title': 'Head of the PS-Place publique list for the European '\n                       'elections'}],\n 'summary': \"Emmanuel Macron critiques the 'hypocrisy' of the National Rally \"\n            '(RN) during the European elections campaign.'}",
    "crumbs": [
      "Instructor (Python)"
    ]
  },
  {
    "objectID": "instructor.html#instructor-with-a-pandas-dataframe",
    "href": "instructor.html#instructor-with-a-pandas-dataframe",
    "title": "Extracting structured data with Instructor",
    "section": "Instructor with a pandas dataframe",
    "text": "Instructor with a pandas dataframe\nYou will often want to use Instructor not just with one element of data, but with many. Let’s try again with a spreadsheet of content!\nAgain, you’ll need your own OpenAI API key to serve as your username and password when connecting Instructor to GPT. You can get yours here. Feel free to email me to borrow one of my API keys, you can find me at js4571@columbia.edu\n\nimport pandas as pd\npd.options.display.max_colwidth = 500\n\ndf = pd.read_csv(\"https://docs.google.com/spreadsheets/d/e/2PACX-1vQlfNIJOmGYG1vK1RkI5sa2R3_0fZohl7FIPwVN6HenlY-RZzzuIAiZ3E2GLITI6bANbYT7Wm1Lk_UA/pub?gid=228719919&single=true&output=csv\")\ndf.head()\n\n\n\n\n\n\n\n\n\nURL\ncontent\n\n\n\n\n0\nhttps://www.nytimes.com/2024/04/17/us/politics/senate-alejandro-mayorkas-impeachment-charge.html\nSenate Dismisses Impeachment Charges Against Mayorkas Without a Trial\\n\\nDemocrats quickly swept aside the articles of impeachment accusing the homeland security secretary of refusing to enforce immigration laws and breach of public trust, calling them unconstitutional.\\n\\nThe Senate on Wednesday dismissed the impeachment case against Alejandro N. Mayorkas, the homeland security secretary, voting along party lines before his trial got underway to sweep aside two charges accusing him of faili...\n\n\n1\nhttps://www.washingtonpost.com/national-security/2024/04/17/niger-air-force-whistleblower/\nDefying Niger exit order leaves U.S. troops vulnerable, whistleblower says\\n\\nDeployed Americans are in limbo, unable to do their jobs or go home while State Department seeks to extend military presence, complaint contends\\n\\nA senior U.S. Air Force leader deployed in Niger is raising an alarm over the Biden administration’s reluctance to heed an eviction notice from the military junta that last year overthrew the West African nation’s democratically elected government.\\n\\nThe airman, in a p...\n\n\n2\nhttps://www.washingtonpost.com/sports/2024/04/17/jake-irvin-nationals-dodgers-road-trip/\nJake Irvin delivers as Nationals beat Dodgers again to close road trip\\n\\nLOS ANGELES — It was only fitting that Jake Irvin’s start Wednesday afternoon at Dodger Stadium ended the way it did: with a high fastball in on the hands of Los Angeles catcher Will Smith.\\n\\nIt was the sixth pitch of the at-bat. The Washington Nationals right-hander had thrown five fastballs in a row. For his sixth pitch, he didn’t deviate from the plan: He fired a fastball by Smith, notching his sixth strikeout in t...\n\n\n3\nhttps://www.lanacion.com.ar/economia/ante-inversores-en-washington-caputo-defendio-la-estrategia-fiscal-y-reafirmo-el-compromiso-para-nid17042024/\nAnte inversores en Washington, Caputo defendió la estrategia fiscal y reafirmó el compromiso para levantar el cepo\\n\\nEl jefe del Palacio de Hacienda participó de un seminario organizado por el banco J.P. Morgan\\n\\nWASHINGTON.- El ministro de Economía, Luis Caputo, llegó al seminario del banco de inversión J.P. Morgan en el Park Hyatt hotel poco después de las tres de la tarde, hora local, un rato después de aterrizar en Washington, junto con el secretario de Finanzas, Pablo Quirno. El títul...\n\n\n4\nhttps://www.lemonde.fr/elections-europeennes/article/2024/04/17/elections-europeennes-emmanuel-macron-denonce-l-hypocrisie-du-rn_6228404_1168667.html\nElections européennes : Emmanuel Macron dénonce « l’hypocrisie » du RN\\n\\nLe chef de l’Etat a déploré mercredi depuis Bruxelles que les « peurs profitent aux réponses les plus simplistes » dans la campagne pour le scrutin du 9 juin, fustigeant ceux qui dénoncent l’Union européenne tout en engrangeant les « dividendes silencieux ».\\n\\nVous pouvez partager un article en cliquant sur les icônes de partage en haut à droite de celui-ci. \\nLa reproduction totale ou partielle d’un article, sans l’a...\n\n\n\n\n\n\n\n\nBefore we get started I’m going to turn on tqdm, which gives us a nice progress bar as we go through each row. If we didn’t have a progress bar we’d never know how much longer we had to wait!\n\nfrom tqdm import tqdm\ntqdm.pandas()\n\nThe process function takes the content column, then sends it to GPT to get a response. You can find a list of available models on OpenAI’s website, but gpt-4o is a good combination of quality and price.\n\ndef process(row):\n    article = row['content']\n\n    result = client.chat.completions.create(\n        model=\"gpt-4o\",\n        response_model=Article,\n        messages=[{\"role\": \"user\", \"content\": article}],\n    )\n\n    # Convert the dictionary into a pandas series\n    return pd.Series(result.model_dump())\n\n# Run process for every row in the dataframe\nai_df = df.progress_apply(process, axis=1)\nai_df.head()\n\n100%|██████████| 6/6 [00:54&lt;00:00,  9.04s/it]\n\n\n\n\n\n\n\n\n\n\nsummary\nsources\nlanguage_code\ncategory\n\n\n\n\n0\nThe Senate dismissed impeachment charges against Homeland Security Secretary Alejandro N. Mayorkas before trial, ruling the charges unconstitutional, with votes largely along party lines.\n[{'name': 'Alejandro N. Mayorkas', 'title': 'Homeland Security Secretary'}, {'name': 'Chuck Schumer', 'title': 'Senator, Majority Leader'}, {'name': 'Lisa Murkowski', 'title': 'Senator'}, {'name': 'Mitch McConnell', 'title': 'Senator, Minority Leader'}, {'name': 'Mike Lee', 'title': 'Senator'}, {'name': 'John Thune', 'title': 'Senator'}, {'name': 'Mia Ehrenberg', 'title': 'Spokeswoman for the Department of Homeland Security'}]\nen\npolitics\n\n\n1\nA senior U.S. Air Force leader in Niger has filed a whistleblower complaint accusing U.S. embassy officials of suppressing intelligence to maintain the appearance of a good relationship with Niger's junta, leaving U.S. troops vulnerable and unable to do their jobs or go home.\n[{'name': 'Kathleen FitzGibbon', 'title': 'Ambassador'}, {'name': 'Nora J. Nelson-Richter', 'title': 'Air Force Col. and Defense Attaché'}, {'name': 'Dusty Johnson', 'title': 'Rep. (R-S.D.)'}]\nen\npolitics\n\n\n2\nJake Irvin's impressive performance leads Nationals to a 2-0 victory over the Dodgers, concluding their road trip with a series win.\n[{'name': 'Jake Irvin', 'title': 'Washington Nationals right-hander'}, {'name': 'Luis García Jr.', 'title': 'second baseman'}, {'name': 'Dave Martinez', 'title': 'Manager'}]\nen\nsports\n\n\n3\nLuis Caputo defendió la estrategia fiscal y reafirmó el compromiso para levantar el cepo ante inversores en Washington, destacando los avances económicos del gobierno de Javier Milei.\n[{'name': 'Luis Caputo', 'title': 'Ministro de Economía'}, {'name': 'Pablo Quirno', 'title': 'Secretario de Finanzas'}, {'name': 'Nicolás Posse', 'title': 'Jefe de Gabinete'}, {'name': 'Pierre-Olivier Gourinchas', 'title': 'Economista jefe del FMI'}]\nes\npolitics\n\n\n4\nFrench President Emmanuel Macron criticizes the National Rally's (RN) \"hypocrisy\" in the European elections campaign, denouncing their anti-EU stance while benefiting from EU policies.\n[{'name': 'Emmanuel Macron', 'title': 'President of France'}, {'name': 'Jordan Bardella', 'title': 'Head of the National Rally's list in the European elections'}, {'name': 'Valérie Heyer', 'title': 'Head of Macron's camp list in the European elections'}, {'name': 'Gabriel Attal', 'title': 'Prime Minister of France'}, {'name': 'Raphaël Glucksmann', 'title': 'Head of the PS-Place publique list'}]\nfr\npolitics\n\n\n\n\n\n\n\n\nNow we can combine the AI results with the original dataframe and save it to a CSV file.\n\nmerged = df.join(ai_df)\nmerged.head()\n\n\n\n\n\n\n\n\n\nURL\ncontent\nsummary\nsources\nlanguage_code\ncategory\n\n\n\n\n0\nhttps://www.nytimes.com/2024/04/17/us/politics/senate-alejandro-mayorkas-impeachment-charge.html\nSenate Dismisses Impeachment Charges Against Mayorkas Without a Trial\\n\\nDemocrats quickly swept...\nThe Senate dismissed impeachment charges against Homeland Security Secretary Alejandro N. Mayork...\n[{'name': 'Alejandro N. Mayorkas', 'title': 'Homeland Security Secretary'}, {'name': 'Chuck Schu...\nen\npolitics\n\n\n1\nhttps://www.washingtonpost.com/national-security/2024/04/17/niger-air-force-whistleblower/\nDefying Niger exit order leaves U.S. troops vulnerable, whistleblower says\\n\\nDeployed Americans...\nA senior U.S. Air Force leader in Niger has filed a whistleblower complaint accusing U.S. embass...\n[{'name': 'Kathleen FitzGibbon', 'title': 'Ambassador'}, {'name': 'Nora J. Nelson-Richter', 'tit...\nen\npolitics\n\n\n2\nhttps://www.washingtonpost.com/sports/2024/04/17/jake-irvin-nationals-dodgers-road-trip/\nJake Irvin delivers as Nationals beat Dodgers again to close road trip\\n\\nLOS ANGELES — It was o...\nJake Irvin's impressive performance leads Nationals to a 2-0 victory over the Dodgers, concludin...\n[{'name': 'Jake Irvin', 'title': 'Washington Nationals right-hander'}, {'name': 'Luis García Jr....\nen\nsports\n\n\n3\nhttps://www.lanacion.com.ar/economia/ante-inversores-en-washington-caputo-defendio-la-estrategia...\nAnte inversores en Washington, Caputo defendió la estrategia fiscal y reafirmó el compromiso par...\nLuis Caputo defendió la estrategia fiscal y reafirmó el compromiso para levantar el cepo ante in...\n[{'name': 'Luis Caputo', 'title': 'Ministro de Economía'}, {'name': 'Pablo Quirno', 'title': 'Se...\nes\npolitics\n\n\n4\nhttps://www.lemonde.fr/elections-europeennes/article/2024/04/17/elections-europeennes-emmanuel-m...\nElections européennes : Emmanuel Macron dénonce « l’hypocrisie » du RN\\n\\nLe chef de l’Etat a dé...\nFrench President Emmanuel Macron criticizes the National Rally's (RN) \"hypocrisy\" in the Europea...\n[{'name': 'Emmanuel Macron', 'title': 'President of France'}, {'name': 'Jordan Bardella', 'title...\nfr\npolitics\n\n\n\n\n\n\n\n\nBeautiful, right??\n\nmerged.to_csv(\"completed.csv\", index=False)",
    "crumbs": [
      "Instructor (Python)"
    ]
  },
  {
    "objectID": "instructor.html#validating-responses-from-the-llm",
    "href": "instructor.html#validating-responses-from-the-llm",
    "title": "Extracting structured data with Instructor",
    "section": "Validating responses from the LLM",
    "text": "Validating responses from the LLM\nOne fun part of Instructor is validating responses, to be able to do follow-up questions with GPT to make sure the responses are correct.\nThe approach below makes sure emails have an @ symbol in them.\n\nimport instructor\nfrom pydantic import BaseModel, Field, field_validator\nfrom openai import OpenAI\nfrom typing import Optional, List\nfrom typing_extensions import Literal\n\nclass Comment(BaseModel):\n    name: str = Field(description=\"Submitter name\")\n    email: str = Field(description=\"Submitter email address\")\n    position: Literal[\"for\", \"against\", \"neutral\"] = Field(\"Position on the regulation\")\n\n    @field_validator(\"email\")\n    @classmethod\n    def validate_email(cls, value):\n        if value and '@' not in value:\n            raise ValueError(\"Email missing @\")\n        return value\n\n# Add your own API key\nclient = instructor.from_openai(OpenAI(api_key='sk-proj-XXXXXXXXXXXXXXXXXXXX'))\n\nIn the example below, Mulberry is hiding his email address by using (at) and (dot). While GPT will usually correctly translate it into mulberry@catmail.com, we can be super certain by demanding that all email addresses have an @ in them.\n\ncomment = \"\"\"\nMy name is Mulberry Pepperstown and I think this regulation is awful!\nYou can respond to this at mulberry (at) catmail (dot) com\n\"\"\"\n\nresult = client.chat.completions.create(\n    model=\"gpt-4o\",\n    response_model=Comment,\n    messages=[{\"role\": \"user\", \"content\": comment}],\n    max_retries=3\n)\n\nWe set a maximum number of retries to allow a back-and-forth conversation with the LLM up to 3 times. And the final answer is… perfect!\n\nresult.model_dump()\n\n{'name': 'Mulberry Pepperstown',\n 'email': 'mulberry@catmail.com',\n 'position': 'against'}",
    "crumbs": [
      "Instructor (Python)"
    ]
  },
  {
    "objectID": "index.html",
    "href": "index.html",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "July 13, 2024, Abraji Congress, São Paulo\nJonathan Soma, Knight Chair in Data Journalism, Columbia University.\nDirector of the MS in Data Journalism (1 year Master’s degree) and Lede Program (10 week summer program).\nFind me at @dangerscarf or js4571@columbia.edu.\n\n\nThis only covers the small, small portion of content that I talked about at Abraji! If you’re interested in hearing more in-depth or broader uses of AI in journalism, look at my 12-hour video series Practical AI for Investigative Journalism.\nIf you’re interested in more programming stuff, take a look at jonathansoma.com and Everything I Know, two places where I put a lot of my content.\n\n\n\nYou can find the slides on the slides page\n\n\n\n\nOpenAI Playground to see probabilities for different texts. You’ll need to select “Completions” on the left and “Show probabilities: Full Spectrum” in the bottom right-hand corner.\nChatbots may hallucinate more often than many realize from The New York Times\nHallucination Leaderboard\nAcaraJazz Instagram page\nAnthropic’s Claude (similar to ChatGPT)\nWashington Post investigation into app store complaints\nThe CITY’s coverage map of stories\n\n\n\n\n\nClaude for Sheets\nAPI keys\n\nOpenAI API key page\nAnthropic’s (Claude) API key page\nIf you want to try it out without signing up, just email me!\n\nGoogle Sheet that uses =CLAUDE\n\n\n\n\n\nInstructor for using Python to extract structured data\n\n\n\n\n\nAnythingLLM for chatting with your documents without Python\nLlamaIndex for chatting with your documents in Python\nMyCity NYC chatbot\nNYC’s AI Chatbot Tells Businesses to Break the Law from The Markup\n\n\n\n\n\nTabula for extracting tables from PDFs\nOCRmyPDF for adding a text layet to image-based PDFs\nSemantra a “semantic search” tool that allows you to do fuzzy/non-exact/vibes-based searching over documents\nInvestigate.ai: Data Science for Journalists, a website on traditional machine learning I built in around 2018",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#notes",
    "href": "index.html#notes",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "This only covers the small, small portion of content that I talked about at Abraji! If you’re interested in hearing more in-depth or broader uses of AI in journalism, look at my 12-hour video series Practical AI for Investigative Journalism.\nIf you’re interested in more programming stuff, take a look at jonathansoma.com and Everything I Know, two places where I put a lot of my content.",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#slides",
    "href": "index.html#slides",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "You can find the slides on the slides page",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#links",
    "href": "index.html#links",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "OpenAI Playground to see probabilities for different texts. You’ll need to select “Completions” on the left and “Show probabilities: Full Spectrum” in the bottom right-hand corner.\nChatbots may hallucinate more often than many realize from The New York Times\nHallucination Leaderboard\nAcaraJazz Instagram page\nAnthropic’s Claude (similar to ChatGPT)\nWashington Post investigation into app store complaints\nThe CITY’s coverage map of stories",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#ai-in-a-spreadsheet",
    "href": "index.html#ai-in-a-spreadsheet",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "Claude for Sheets\nAPI keys\n\nOpenAI API key page\nAnthropic’s (Claude) API key page\nIf you want to try it out without signing up, just email me!\n\nGoogle Sheet that uses =CLAUDE",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#ai-in-python",
    "href": "index.html#ai-in-python",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "Instructor for using Python to extract structured data",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#rag-chatting-with-your-pdfs",
    "href": "index.html#rag-chatting-with-your-pdfs",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "AnythingLLM for chatting with your documents without Python\nLlamaIndex for chatting with your documents in Python\nMyCity NYC chatbot\nNYC’s AI Chatbot Tells Businesses to Break the Law from The Markup",
    "crumbs": [
      "Lots of links"
    ]
  },
  {
    "objectID": "index.html#other-links",
    "href": "index.html#other-links",
    "title": "Investigating Documents using AI",
    "section": "",
    "text": "Tabula for extracting tables from PDFs\nOCRmyPDF for adding a text layet to image-based PDFs\nSemantra a “semantic search” tool that allows you to do fuzzy/non-exact/vibes-based searching over documents\nInvestigate.ai: Data Science for Journalists, a website on traditional machine learning I built in around 2018",
    "crumbs": [
      "Lots of links"
    ]
  }
]